<link href='http://fonts.googleapis.com/css?family=Raleway:500' rel='stylesheet' type='text/css' />
<link rel="stylesheet" type="text/css" href="/static/registerstyle.css" />
<link rel="stylesheet" type="text/css" href="/static/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/static/bootstrap-social.css" />
<link rel="stylesheet" type="text/css" href="/static/font-awesome/css/font-awesome.css" />
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>


<body>
<div class="middlePage">
    <div class="page-header">
        <h1 class="logo">EServ <small>Authentication service webpage</small></h1>
    </div>
    <div class="panel panel-info">
        <div class="panel-heading">
            <h3 class="panel-title">Registration</h3>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="container">
                    <div class="col-lg-9">
                        <div class="row">
                            <form>
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div id="1" class="col-sm-6 form-group">
                                            <label>First Name</label>
                                            <input id="firstname" type="text" placeholder="Enter First Name Here" class="form-control">
                                        </div>
                                        <div id="2" class="col-sm-6 form-group">
                                            <label>Last Name</label>
                                            <input id="lastname" type="text" placeholder="Enter Last Name Here" class="form-control">
                                        </div>
                                    </div>
                                    <div id="3" class="form-group">
                                        <label>Email</label>
                                        <input id="email" type="text" placeholder="Enter Email Here" class="form-control">
                                    </div>
                                    <div id="4" class="form-group">
                                        <label>Username</label>
                                        <input id="username" type="text" placeholder="Enter Username Here" class="form-control">
                                    </div>
                                    <div id="5" class="form-group">
                                        <label>Password</label>
                                        <input id="password" type="password" placeholder="Enter Password Here" class="form-control">
                                    </div>
                                    <div id="6" class="form-group">
                                        <label>Confirm password please</label>
                                        <input id="repwd" type="password" placeholder="Re-enter Password Here" class="form-control">
                                    </div>
                                    <button id="submit" type="button" class="btn btn-lg btn-info">Submit</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    $(function(){
        $('#submit').on('click', function (e) {
            var firstname_form = document.getElementById("1");
            var fn = firstname_form.lastElementChild.value;
            var lastname_form = document.getElementById("2");
            var ln = lastname_form.lastElementChild.value;
            var email_form = document.getElementById("3");
            var em = email_form.lastElementChild.value;
            var username_form = document.getElementById("4");
            var un = username_form.lastElementChild.value;
            var pwd_form = document.getElementById("5");
            var pwd = pwd_form.lastElementChild.value;
            var rpwd_form = document.getElementById("6");
            var rpwd = rpwd_form.lastElementChild.value;

            var hashedPW = hashCode(pwd);
            alert(hashedPW)

            var json = '{"username":"' + un + '", "hashedPW":"' + hashedPW + '", "firstname":"' + fn + '", "lastname":"' + ln + '", "email":"' + em + '"}';

            $.ajax({
                url: 'http://localhost:5000/auth/api/users',
                type: 'POST',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: json,
                success: function(data) { alert('POST completed ' + JSON.stringify(data)); },
                error:function() { alert('Something happened'); }
            });
        });
    });

    // http://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript-jquery
    function hashCode(password) {
        var hash = 0, i, chr, len;
        if (password.length == 0) return hash;
        for (i = 0, len = password.length; i < len; i++) {
            chr   = password.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

</script>
</body>